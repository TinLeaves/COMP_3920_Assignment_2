<%- include("templates/header") %>
<% if (authenticated) { %>
  <h2>Your Chats</h2>
  <table style="width: 100%;">
      <thead>
          <tr>
              <th style="padding: 5px; text-align: left;">Group Name</th>
              <th style="padding: 5px; text-align: left;">Last Message</th>
              <th style="padding: 5px; text-align: left;">Unread Messages</th>
          </tr>
      </thead>
      <tbody>
          <% userGroups.forEach(group => { %>
              <tr>
                  <td style="padding: 5px; text-align: left;"><%= group.name %></td>
                  <td style="padding: 5px; text-align: left;">
                      <% if (group.last_message_date) { %>
                          <% if (group.days_since_last_message === 0) { %>
                              <%= group.last_message_date %> (today)
                          <% } else if (group.days_since_last_message === 1) { %>
                              <%= group.last_message_date %> (yesterday)
                          <% } else { %>
                              <%= group.last_message_date %> (<%= group.days_since_last_message %> days ago)
                          <% } %>
                      <% } else { %>
                          No messages
                      <% } %>
                  </td>
                  <td style="padding: 5px; text-align: left;"><%= group.unread_messages %></td>
              </tr>
          <% }); %>
      </tbody>
  </table>

  <p>Total Groups: <%= totalGroups %></p>
  <form action="/createGroup" method="GET">
    <button type="submit">Create Group</button>
</form>
<% } else { %>
  <a href="/signup"><button>Sign Up</button></a><br>
  <a href="/login"><button>Log In</button></a>
<% } %>

<%- include("templates/footer") %>
